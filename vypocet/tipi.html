<!DOCTYPE html>
<html lang="cs">

<head>
    <meta charset="UTF-8" />
    <title>Půlkruh z pruhů látky</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            margin: 20px;
            background: #f7f7fa;
            color: #222;
        }

        h1 {
            font-size: 1.4rem;
            margin-bottom: 0.5rem;
        }

        h2 {
            margin-top: 2rem;
        }

        .controls {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            align-items: flex-end;
            margin-bottom: 1rem;
            padding: 0.75rem 1rem;
            border-radius: 12px;
            background: #ffffff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
        }

        .field {
            display: flex;
            flex-direction: column;
            gap: 0.25rem;
            font-size: 0.9rem;
        }

        .field input {
            padding: 0.3rem 0.5rem;
            border-radius: 6px;
            border: 1px solid #ccc;
            min-width: 90px;
        }

        button {
            padding: 0.4rem 0.9rem;
            border-radius: 999px;
            border: none;
            background: #4a6cf7;
            color: white;
            cursor: pointer;
            font-weight: 600;
        }

        button:hover {
            background: #3b59cf;
        }

        #canvasWrapper {
            background: #ffffff;
            padding: 0.75rem;
            border-radius: 12px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
            margin-bottom: 1rem;
        }

        canvas {
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #fcfcff;
        }

        table {
            border-collapse: collapse;
            margin-top: 0.5rem;
            background: #ffffff;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
        }

        th,
        td {
            padding: 0.4rem 0.7rem;
            border-bottom: 1px solid #eee;
            font-size: 0.9rem;
            text-align: right;
        }

        th:first-child,
        td:first-child {
            text-align: left;
        }

        th {
            background: #f0f2ff;
            font-weight: 600;
        }

        tr:last-child td {
            border-bottom: none;
        }

        #error {
            color: #c0392b;
            margin-top: 0.4rem;
            font-size: 0.85rem;
        }
    </style>
</head>

<body>
    <h1>Půlkruh z vodorovných pruhů látky</h1>
    <div class="controls">
        <div class="field">
            <label for="radius">Poloměr R (cm)</label>
            <input id="radius" type="number" min="1" value="600" step="1">
        </div>
        <div class="field">
            <label for="stripHeight">Šířka pruhu (cm)</label>
            <input id="stripHeight" type="number" min="1" value="145" step="1">
        </div>
        <button id="updateBtn">Přepočítat &amp; překreslit</button>
        <div id="error"></div>
    </div>

    <div id="canvasWrapper">
        <canvas id="plot" width="800" height="500"></canvas>
    </div>

    <h2>Délky pruhů (horní hrany)</h2>
    <div id="tableContainer"></div>

    <h2>Odstřihy (vodorovné vzdálenosti ke kružnici)</h2>
    <div id="cutTableContainer"></div>

    <script>
        const canvas = document.getElementById('plot');
        const ctx = canvas.getContext('2d');
        const radiusInput = document.getElementById('radius');
        const stripInput = document.getElementById('stripHeight');
        const errorEl = document.getElementById('error');
        const tableContainer = document.getElementById('tableContainer');
        const cutTableContainer = document.getElementById('cutTableContainer');

        // ------------------------------------------------------
        //  Výpočet VODOROVNÉHO odstřihu
        // ------------------------------------------------------
        function horizontalCut(R, yStrip, t) {
            const y = yStrip + t;
            if (y >= R) return 0;

            const xCurve = Math.sqrt(R * R - y * y);
            const xStrip = Math.sqrt(R * R - yStrip * yStrip);

            return xStrip - xCurve;
        }

        // ------------------------------------------------------
        //  Vytvoření tabulky odstřihů
        // ------------------------------------------------------

        function generateCutTable(strips, R, step = 10) {
            const colors = ["#ffe6e6", "#e6f0ff", "#f3e6ff", "#e6ffe6", "#f2f2f2", "#fff2e6"];

            let html = "<table><thead><tr>" +
                "<th>Pruh</th>" +
                "<th>Výška od spodní hrany (cm)</th>" +
                "<th>Odstřih dovnitř (cm)</th>" +
                "</tr></thead><tbody>";

            strips.forEach((sh, idx) => {

                const stripNumber = idx + 1;
                const color = colors[idx % colors.length];
                const yStrip = sh.yBottom;
                const height = sh.yTop - sh.yBottom;

                for (let t = 0; t <= height; t += step) {
                    const cut = horizontalCut(R, yStrip, t);

                    html += `<tr style="background:${color}">
                <td>${stripNumber}</td>
                <td>${t}</td>
                <td>${cut.toFixed(2)}</td>
            </tr>`;
                }

                if (height % step !== 0) {
                    const cut = horizontalCut(R, yStrip, height);
                    html += `<tr style="background:${color}">
                <td>${stripNumber}</td>
                <td>${height}</td>
                <td>${cut.toFixed(2)}</td>
            </tr>`;
                }
            });

            html += "</tbody></table>";
            return html;
        }


        // ------------------------------------------------------
        //  Hlavní kreslící funkce
        // ------------------------------------------------------
        function draw() {
            const R = parseFloat(radiusInput.value);
            const a = parseFloat(stripInput.value);
            errorEl.textContent = "";

            if (isNaN(R) || isNaN(a) || R <= 0 || a <= 0) {
                errorEl.textContent = "Zadej kladné hodnoty R a šířky pruhu.";
                return;
            }
            if (a > R) {
                errorEl.textContent = "Šířka pruhu je větší než poloměr – zmenši a.";
                return;
            }

            // pruhy
            const fullStrips = Math.floor(R / a);
            const remainder = R - fullStrips * a;
            const stripHeights = [];
            let y = 0;
            for (let i = 0; i < fullStrips; i++) {
                stripHeights.push({ yBottom: y, yTop: y + a });
                y += a;
            }
            if (remainder > 0.0001) {
                stripHeights.push({ yBottom: y, yTop: R });
            }

            // délky pruhů
            const lengths = [];
            stripHeights.forEach((sh, idx) => {
                if (idx === 0) {
                    lengths.push({ index: 1, yTop: sh.yTop, length: 2 * R });
                } else {
                    const yPrevTop = stripHeights[idx - 1].yTop;
                    const len = 2 * Math.sqrt(Math.max(0, R * R - yPrevTop * yPrevTop));
                    lengths.push({ index: idx + 1, yTop: sh.yTop, length: len });
                }
            });

            // vykreslení canvasu
            const margin = 40;
            const w = canvas.width;
            const h = canvas.height;
            ctx.clearRect(0, 0, w, h);

            const scale = Math.min(
                (w - 2 * margin) / (2 * R),
                (h - 2 * margin) / R
            );

            function toScreenX(x) {
                return w / 2 + x * scale;
            }
            function toScreenY(yVal) {
                return h - margin - yVal * scale;
            }

            // pozadí
            ctx.fillStyle = "#fcfcff";
            ctx.fillRect(0, 0, w, h);

            // půlkružnice
            ctx.strokeStyle = "#f39c12";
            ctx.lineWidth = 2.5;
            ctx.beginPath();
            for (let t = 0; t <= Math.PI + 0.001; t += Math.PI / 180) {
                const x = R * Math.cos(t);
                const yVal = R * Math.sin(t);
                const sx = toScreenX(x);
                const sy = toScreenY(yVal);
                if (t === 0) ctx.moveTo(sx, sy);
                else ctx.lineTo(sx, sy);
            }
            ctx.stroke();

            // pruhy
            const colors = ["#e74c3c", "#2980b9", "#9b59b6", "#27ae60", "#7f8c8d", "#e67e22"];
            const letters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

            stripHeights.forEach((sh, idx) => {
                const stripIndex = idx + 1;
                const color = colors[idx % colors.length];
                const lengthObj = lengths[idx];
                const L = lengthObj.length;
                const yBottom = sh.yBottom;
                const yTop = sh.yTop;

                const xLeft = -L / 2;
                const xRight = L / 2;

                // pruh
                ctx.strokeStyle = color;
                ctx.lineWidth = 2;
                ctx.beginPath();
                ctx.rect(
                    toScreenX(xLeft),
                    toScreenY(yTop),
                    (xRight - xLeft) * scale,
                    (yTop - yBottom) * scale
                );
                ctx.stroke();

                // průsečík s kružnicí
                if (yTop < R - 1e-6) {
                    const xInt = Math.sqrt(Math.max(0, R * R - yTop * yTop));
                    const sx1 = toScreenX(xInt);
                    const sx2 = toScreenX(-xInt);
                    const sy = toScreenY(yTop);

                    const label = letters[idx];

                    ctx.fillStyle = color;
                    ctx.beginPath();
                    ctx.arc(sx1, sy, 4, 0, 2 * Math.PI);
                    ctx.fill();
                    ctx.beginPath();
                    ctx.arc(sx2, sy, 4, 0, 2 * Math.PI);
                    ctx.fill();

                    ctx.font = "12px system-ui";
                    ctx.fillText(label, sx1 + 8, sy - 4);
                    ctx.fillText(label, sx2 - 14, sy - 4);
                }
            });

            // tabulka délek
            let html = "<table><thead><tr><th>Pruh</th><th>Horní výška y (cm)</th><th>Délka horní hrany (cm)</th></tr></thead><tbody>";
            lengths.forEach(obj => {
                html += `<tr>
          <td>${obj.index}</td>
          <td>${obj.yTop.toFixed(2)}</td>
          <td>${obj.length.toFixed(2)}</td>
        </tr>`;
            });
            html += "</tbody></table>";
            tableContainer.innerHTML = html;

            // -----------------------
            //  TABULKA ODSTŘIHŮ
            // -----------------------
            const cutHTML = generateCutTable(stripHeights, R, 10);
            cutTableContainer.innerHTML = cutHTML;
        }

        // Eventy
        document.getElementById('updateBtn').addEventListener('click', draw);
        radiusInput.addEventListener('change', draw);
        stripInput.addEventListener('change', draw);

        // první vykreslení
        draw();
    </script>
</body>

</html>